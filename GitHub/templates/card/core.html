<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BattleScript Core - –ò–≥—Ä–æ–≤–æ–π –¥–≤–∏–∂–æ–∫</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --team-a-color: #ef476f;
            --team-b-color: #118ab2;
            --mana-color: #6930c3;
            --health-color: #06d6a0;
            --attack-color: #f72585;
            --dark-bg: #0a0a1a;
            --card-bg: #1d2d44;
            --text-color: #e0e1dd;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark-bg) 0%, #15152b 100%);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 25px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        header:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--team-a-color), #ffd166, var(--team-b-color));
            animation: gradientShift 3s infinite linear;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        
        h1 {
            font-size: 3.5rem;
            margin-bottom: 15px;
            background: linear-gradient(90deg, var(--team-a-color), #ffd166, var(--team-b-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.4rem;
            color: #a0a0c0;
            margin-bottom: 25px;
        }
        
        .load-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .load-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            margin-top: 25px;
        }
        
        .file-input-group {
            flex: 1;
            min-width: 300px;
        }
        
        .file-input-group label {
            display: block;
            margin-bottom: 12px;
            color: #64dfdf;
            font-weight: 600;
            font-size: 1.2rem;
        }
        
        .file-input-group input[type="file"] {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            color: #fff;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .load-info {
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            font-size: 1rem;
            color: #a0a0c0;
            border: 2px solid rgba(255, 255, 255, 0.1);
            margin-top: 15px;
        }
        
        .game-board {
            display: grid;
            grid-template-columns: 1fr 400px 1fr;
            gap: 30px;
            margin-bottom: 40px;
            min-height: 800px;
        }
        
        @media (max-width: 1400px) {
            .game-board {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
            }
        }
        
        .team-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 25px;
            padding: 25px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            border: 3px solid;
            display: flex;
            flex-direction: column;
        }
        
        .team-a {
            border-color: var(--team-a-color);
        }
        
        .team-b {
            border-color: var(--team-b-color);
        }
        
        .team-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .team-title {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .team-a .team-title {
            color: var(--team-a-color);
        }
        
        .team-b .team-title {
            color: var(--team-b-color);
        }
        
        .team-stats {
            display: flex;
            gap: 20px;
        }
        
        .stat {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .mana {
            color: var(--mana-color);
        }
        
        .health {
            color: var(--health-color);
        }
        
        .cards-container {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
            max-height: 350px;
        }
        
        .board-container {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            margin-top: 20px;
            min-height: 250px;
        }
        
        .card {
            background: linear-gradient(145deg, var(--card-bg), #0f1a2a);
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            min-height: 200px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }
        
        .card.selected {
            border-color: #ffd166;
            box-shadow: 0 0 20px rgba(255, 209, 102, 0.5);
        }
        
        .card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .card.disabled:hover {
            transform: none;
        }
        
        .card-creature {
            border-color: #4ade80;
        }
        
        .card-spell {
            border-color: #4cc9f0;
        }
        
        .card-artifact {
            border-color: #fbbf24;
        }
        
        .card-avatar {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 10px;
            background: rgba(0, 0, 0, 0.3);
        }
        
        .avatar-placeholder {
            width: 100%;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.3);
            font-size: 2rem;
        }
        
        .card-name {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: #ffd166;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .card-cost {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--mana-color);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1rem;
        }
        
        .card-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        .stat-attack, .stat-health {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: 8px;
            font-weight: bold;
        }
        
        .stat-attack {
            background: rgba(247, 37, 133, 0.2);
            color: var(--attack-color);
        }
        
        .stat-health {
            background: rgba(6, 214, 160, 0.2);
            color: var(--health-color);
        }
        
        .card-abilities {
            font-size: 0.8rem;
            color: #a0a0c0;
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .ability-tag {
            background: rgba(105, 48, 195, 0.3);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
        }
        
        .game-center {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .turn-indicator {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .turn-title {
            font-size: 1.2rem;
            color: #a0a0c0;
            margin-bottom: 10px;
        }
        
        .turn-team {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .turn-a {
            color: var(--team-a-color);
        }
        
        .turn-b {
            color: var(--team-b-color);
        }
        
        .turn-number {
            font-size: 1.5rem;
            color: #ffd166;
        }
        
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .btn {
            padding: 18px;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(90deg, var(--mana-color), #8338ec);
            color: white;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-success {
            background: linear-gradient(90deg, var(--health-color), #4ce3b5);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(90deg, var(--attack-color), #ff6b8b);
            color: white;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn:not(:disabled):hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .game-log {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 25px;
            padding: 25px;
            margin-top: 40px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            height: 400px;
            display: flex;
            flex-direction: column;
        }
        
        .log-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #64dfdf;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .log-messages {
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding-right: 10px;
        }
        
        .log-message {
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border-left: 4px solid;
            font-size: 0.9rem;
        }
        
        .log-turn {
            border-left-color: #ffd166;
        }
        
        .log-attack {
            border-left-color: var(--attack-color);
        }
        
        .log-heal {
            border-left-color: var(--health-color);
        }
        
        .log-spell {
            border-left-color: #4cc9f0;
        }
        
        .log-artifact {
            border-left-color: #fbbf24;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: linear-gradient(145deg, var(--card-bg), #0f1a2a);
            border-radius: 25px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 3px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
        }
        
        .victory-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .victory-content {
            background: linear-gradient(145deg, var(--card-bg), #0f1a2a);
            border-radius: 30px;
            padding: 50px;
            text-align: center;
            border: 5px solid #ffd166;
            max-width: 600px;
            width: 90%;
        }
        
        .victory-title {
            font-size: 3rem;
            color: #ffd166;
            margin-bottom: 30px;
        }
        
        .victory-team {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 20px;
        }
        
        .victory-a {
            color: var(--team-a-color);
            background: rgba(239, 71, 111, 0.2);
        }
        
        .victory-b {
            color: var(--team-b-color);
            background: rgba(17, 138, 178, 0.2);
        }
        
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 3000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            gap: 20px;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top-color: #64dfdf;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .section-title {
            font-size: 1.3rem;
            color: #a0a0c0;
            margin: 20px 0 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .empty-message {
            text-align: center;
            color: #a0a0c0;
            font-style: italic;
            padding: 40px;
            grid-column: 1 / -1;
        }
        
        .card-type {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.6);
        }
        
        .type-creature {
            color: #4ade80;
        }
        
        .type-spell {
            color: #4cc9f0;
        }
        
        .type-artifact {
            color: #fbbf24;
        }
        
        .card-can-attack {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 12px;
            height: 12px;
            background: #ffd166;
            border-radius: 50%;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        .avatar-error {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(239, 71, 111, 0.9);
            color: white;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 0.7rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-gamepad"></i> BattleScript Core</h1>
            <p class="subtitle">–£–ª—É—á—à–µ–Ω–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ —Å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏ –∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è–º–∏</p>
            <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–∞—Ä—Ç—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –≤ BattleScript Creator</p>
        </header>
        
        <section class="load-section">
            <h2><i class="fas fa-folder-open"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç –∫–æ–º–∞–Ω–¥</h2>
            <div class="load-controls">
                <div class="file-input-group">
                    <label for="teamAInput"><i class="fas fa-users" style="color: var(--team-a-color);"></i> –ö–∞—Ä—Ç—ã –∫–æ–º–∞–Ω–¥—ã A</label>
                    <input type="file" id="teamAInput" accept=".md" multiple>
                    <div class="load-info" id="teamAInfo">–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∫–∞—Ä—Ç: 0</div>
                </div>
                
                <div class="file-input-group">
                    <label for="teamBInput"><i class="fas fa-users" style="color: var(--team-b-color);"></i> –ö–∞—Ä—Ç—ã –∫–æ–º–∞–Ω–¥—ã B</label>
                    <input type="file" id="teamBInput" accept=".md" multiple>
                    <div class="load-info" id="teamBInfo">–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∫–∞—Ä—Ç: 0</div>
                </div>
                
                <div style="display: flex; align-items: flex-end; gap: 15px;">
                    <button class="btn btn-primary" id="startGameBtn">
                        <i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
                    </button>
                    <button class="btn btn-secondary" id="testModeBtn">
                        <i class="fas fa-vial"></i> –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
                    </button>
                </div>
            </div>
        </section>
        
        <div class="game-board">
            <!-- –ö–æ–º–∞–Ω–¥–∞ A -->
            <div class="team-section team-a">
                <div class="team-header">
                    <div class="team-title">–ö–æ–º–∞–Ω–¥–∞ A</div>
                    <div class="team-stats">
                        <div class="stat mana">
                            <i class="fas fa-gem"></i>
                            <span id="teamAMana">10</span>
                        </div>
                        <div class="stat health">
                            <i class="fas fa-heart"></i>
                            <span id="teamAHealth">30</span>
                        </div>
                    </div>
                </div>
                
                <div class="section-title">
                    <i class="fas fa-hand-paper"></i> –†—É–∫–∞
                </div>
                <div class="cards-container" id="teamAHand">
                    <!-- –ö–∞—Ä—Ç—ã –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –∑–¥–µ—Å—å -->
                </div>
                
                <div class="section-title">
                    <i class="fas fa-chess-board"></i> –ü–æ–ª–µ –±–æ—è
                </div>
                <div class="board-container" id="teamABoard">
                    <!-- –°—É—â–µ—Å—Ç–≤–∞ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <!-- –¶–µ–Ω—Ç—Ä –∏–≥—Ä—ã -->
            <div class="game-center">
                <div class="turn-indicator">
                    <div class="turn-title">–°–µ–π—á–∞—Å —Ö–æ–¥–∏—Ç</div>
                    <div class="turn-team turn-a" id="currentTeam">–ö–æ–º–∞–Ω–¥–∞ A</div>
                    <div class="turn-number" id="turnNumber">–•–æ–¥ 1</div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="endTurnBtn">
                        <i class="fas fa-forward"></i> –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ö–æ–¥
                    </button>
                    <button class="btn btn-secondary" id="drawCardBtn">
                        <i class="fas fa-plus-circle"></i> –í–∑—è—Ç—å –∫–∞—Ä—Ç—É
                    </button>
                    <button class="btn btn-success" id="playCardBtn" disabled>
                        <i class="fas fa-play-circle"></i> –†–∞–∑—ã–≥—Ä–∞—Ç—å –∫–∞—Ä—Ç—É
                    </button>
                    <button class="btn btn-danger" id="attackBtn" disabled>
                        <i class="fas fa-crosshairs"></i> –ê–≤—Ç–æ-–∞—Ç–∞–∫–∞
                    </button>
                    <button class="btn btn-secondary" id="restartBtn">
                        <i class="fas fa-redo"></i> –ù–æ–≤–∞—è –∏–≥—Ä–∞
                    </button>
                </div>
                
                <div style="margin-top: auto;">
                    <a href="creator.html" class="btn btn-secondary" style="width: 100%;">
                        <i class="fas fa-external-link-alt"></i> –ü–µ—Ä–µ–π—Ç–∏ –≤ Creator
                    </a>
                </div>
            </div>
            
            <!-- –ö–æ–º–∞–Ω–¥–∞ B -->
            <div class="team-section team-b">
                <div class="team-header">
                    <div class="team-title">–ö–æ–º–∞–Ω–¥–∞ B</div>
                    <div class="team-stats">
                        <div class="stat mana">
                            <i class="fas fa-gem"></i>
                            <span id="teamBMana">10</span>
                        </div>
                        <div class="stat health">
                            <i class="fas fa-heart"></i>
                            <span id="teamBHealth">30</span>
                        </div>
                    </div>
                </div>
                
                <div class="section-title">
                    <i class="fas fa-hand-paper"></i> –†—É–∫–∞
                </div>
                <div class="cards-container" id="teamBHand">
                    <!-- –ö–∞—Ä—Ç—ã –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –∑–¥–µ—Å—å -->
                </div>
                
                <div class="section-title">
                    <i class="fas fa-chess-board"></i> –ü–æ–ª–µ –±–æ—è
                </div>
                <div class="board-container" id="teamBBoard">
                    <!-- –°—É—â–µ—Å—Ç–≤–∞ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
        
        <div class="game-log">
            <div class="log-title">
                <i class="fas fa-scroll"></i> –ñ—É—Ä–Ω–∞–ª –±–æ—è
            </div>
            <div class="log-messages" id="logMessages">
                <div class="log-message log-turn">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ BattleScript Core!</div>
                <div class="log-message">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–∞—Ä—Ç—ã –∫–æ–º–∞–Ω–¥ –∏ –Ω–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É</div>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn btn-secondary" id="clearCardsBtn">
                <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –∫–∞—Ä—Ç—ã
            </button>
            <button class="btn btn-primary" id="helpBtn">
                <i class="fas fa-question-circle"></i> –ü–æ–º–æ—â—å
            </button>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π –∫–∞—Ä—Ç—ã -->
    <div class="modal" id="cardModal">
        <div class="modal-content">
            <button class="close-modal" id="closeModalBtn">&times;</button>
            <h2 id="modalCardName">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã</h2>
            <div style="margin: 20px 0;">
                <div id="modalAvatarContainer">
                    <!-- –ê–≤–∞—Ç–∞—Ä –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∑–¥–µ—Å—å -->
                </div>
            </div>
            <div style="display: flex; gap: 20px; margin: 20px 0;">
                <div style="flex: 1; text-align: center;">
                    <div style="font-size: 2rem; font-weight: bold; color: var(--mana-color);" id="modalCardCost">5</div>
                    <div style="color: #a0a0c0;">–°—Ç–æ–∏–º–æ—Å—Ç—å</div>
                </div>
                <div style="flex: 1; text-align: center;">
                    <div style="font-size: 2rem; font-weight: bold; color: var(--attack-color);" id="modalCardAttack">5</div>
                    <div style="color: #a0a0c0;">–ê—Ç–∞–∫–∞</div>
                </div>
                <div style="flex: 1; text-align: center;">
                    <div style="font-size: 2rem; font-weight: bold; color: var(--health-color);" id="modalCardHealth">5</div>
                    <div style="color: #a0a0c0;">–ó–¥–æ—Ä–æ–≤—å–µ</div>
                </div>
            </div>
            <div style="margin: 20px 0;">
                <strong>–¢–∏–ø:</strong> <span id="modalCardType" style="color: #ffd166;">–°—É—â–µ—Å—Ç–≤–æ</span>
            </div>
            <div style="margin: 20px 0;">
                <strong>–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:</strong>
                <div id="modalCardAbilities" style="margin-top: 10px; color: #a0a0c0;">–ù–µ—Ç</div>
            </div>
            <div style="margin: 20px 0;">
                <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong>
                <div id="modalCardDescription" style="margin-top: 10px; line-height: 1.6;">–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã...</div>
            </div>
            <div style="margin: 20px 0;">
                <strong>–°–æ–∑–¥–∞—Ç–µ–ª—å:</strong> <span id="modalCardCreator" style="color: #64dfdf;">–°—Ç—É–¥–µ–Ω—Ç</span>
            </div>
        </div>
    </div>
    
    <!-- –≠–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã -->
    <div class="modal victory-screen" id="victoryScreen">
        <div class="victory-content">
            <h2 class="victory-title">üéâ –ü–æ–±–µ–¥–∞! üéâ</h2>
            <div class="victory-team victory-a" id="victoryTeam">–ö–æ–º–∞–Ω–¥–∞ A</div>
            <p style="font-size: 1.2rem; margin-bottom: 30px; color: #a0a0c0;">–æ–¥–µ—Ä–∂–∞–ª–∞ –ø–æ–±–µ–¥—É –≤ —ç–ø–∏—á–µ—Å–∫–æ–º —Å—Ä–∞–∂–µ–Ω–∏–∏!</p>
            <div style="display: flex; justify-content: center; gap: 30px; margin-bottom: 40px;">
                <div>
                    <div style="font-size: 2rem; font-weight: bold; color: #ffd166;" id="victoryTurn">5</div>
                    <div style="color: #a0a0c0;">–•–æ–¥–æ–≤</div>
                </div>
                <div>
                    <div style="font-size: 2rem; font-weight: bold; color: #ffd166;" id="victoryCards">12</div>
                    <div style="color: #a0a0c0;">–ö–∞—Ä—Ç —Å—ã–≥—Ä–∞–Ω–æ</div>
                </div>
                <div>
                    <div style="font-size: 2rem; font-weight: bold; color: #ffd166;" id="victoryDamage">48</div>
                    <div style="color: #a0a0c0;">–£—Ä–æ–Ω–∞</div>
                </div>
            </div>
            <button class="btn btn-primary" id="newGameBtn" style="width: 100%;">
                <i class="fas fa-redo"></i> –ù–æ–≤–∞—è –∏–≥—Ä–∞
            </button>
        </div>
    </div>
    
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="loading" id="loadingIndicator">
        <div class="loading-spinner"></div>
        <div style="font-size: 1.2rem; color: #64dfdf;">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç...</div>
    </div>
    
    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        const gameState = {
            currentTurn: 'A',
            turnNumber: 1,
            selectedCard: null,
            gameStarted: false,
            gameOver: false,
            totalDamage: 0,
            totalCardsPlayed: 0,
            
            teamA: {
                mana: 10,
                maxMana: 10,
                health: 30,
                deck: [],
                hand: [],
                board: []
            },
            
            teamB: {
                mana: 10,
                maxMana: 10,
                health: 30,
                deck: [],
                hand: [],
                board: []
            },
            
            logs: []
        };
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const elements = {
            teamAHand: document.getElementById('teamAHand'),
            teamABoard: document.getElementById('teamABoard'),
            teamBHand: document.getElementById('teamBHand'),
            teamBBoard: document.getElementById('teamBBoard'),
            teamAMana: document.getElementById('teamAMana'),
            teamAHealth: document.getElementById('teamAHealth'),
            teamBMana: document.getElementById('teamBMana'),
            teamBHealth: document.getElementById('teamBHealth'),
            currentTeam: document.getElementById('currentTeam'),
            turnNumber: document.getElementById('turnNumber'),
            logMessages: document.getElementById('logMessages'),
            teamAInfo: document.getElementById('teamAInfo'),
            teamBInfo: document.getElementById('teamBInfo'),
            
            // –ö–Ω–æ–ø–∫–∏
            endTurnBtn: document.getElementById('endTurnBtn'),
            drawCardBtn: document.getElementById('drawCardBtn'),
            playCardBtn: document.getElementById('playCardBtn'),
            attackBtn: document.getElementById('attackBtn'),
            restartBtn: document.getElementById('restartBtn'),
            startGameBtn: document.getElementById('startGameBtn'),
            testModeBtn: document.getElementById('testModeBtn'),
            clearCardsBtn: document.getElementById('clearCardsBtn'),
            helpBtn: document.getElementById('helpBtn'),
            newGameBtn: document.getElementById('newGameBtn'),
            
            // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
            cardModal: document.getElementById('cardModal'),
            victoryScreen: document.getElementById('victoryScreen'),
            loadingIndicator: document.getElementById('loadingIndicator'),
            
            // –ú–æ–¥–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            modalCardName: document.getElementById('modalCardName'),
            modalCardCost: document.getElementById('modalCardCost'),
            modalCardAttack: document.getElementById('modalCardAttack'),
            modalCardHealth: document.getElementById('modalCardHealth'),
            modalCardType: document.getElementById('modalCardType'),
            modalCardAbilities: document.getElementById('modalCardAbilities'),
            modalCardDescription: document.getElementById('modalCardDescription'),
            modalCardCreator: document.getElementById('modalCardCreator'),
            modalAvatarContainer: document.getElementById('modalAvatarContainer'),
            
            // –ü–æ–±–µ–¥–∞
            victoryTeam: document.getElementById('victoryTeam'),
            victoryTurn: document.getElementById('victoryTurn'),
            victoryCards: document.getElementById('victoryCards'),
            victoryDamage: document.getElementById('victoryDamage'),
            
            // –§–∞–π–ª–æ–≤—ã–µ –∏–Ω–ø—É—Ç—ã
            teamAInput: document.getElementById('teamAInput'),
            teamBInput: document.getElementById('teamBInput')
        };
        
        // –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function addLog(message, type = 'normal') {
            const logEntry = {
                message,
                type,
                timestamp: new Date().toLocaleTimeString()
            };
            
            gameState.logs.push(logEntry);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π
            if (gameState.logs.length > 50) {
                gameState.logs.shift();
            }
            
            updateLogUI();
        }
        
        function updateLogUI() {
            elements.logMessages.innerHTML = '';
            
            gameState.logs.forEach(log => {
                const div = document.createElement('div');
                div.className = `log-message log-${log.type}`;
                div.innerHTML = `<strong>[${log.timestamp}]</strong> ${log.message}`;
                elements.logMessages.appendChild(div);
            });
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
            elements.logMessages.scrollTop = elements.logMessages.scrollHeight;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞—Ä—Ç –∏–∑ Markdown
        function parseCardFromMarkdown(markdown, team) {
            const lines = markdown.split('\n');
            const card = {
                id: 'card_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                name: '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è',
                type: 'creature',
                cost: 1,
                attack: 0,
                health: 1,
                abilities: [],
                description: '',
                creator: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å—Ç—É–¥–µ–Ω—Ç',
                avatar: '',
                team: team,
                canAttack: false,
                maxHealth: 1,
                avatarError: false
            };
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (line.startsWith('# ')) {
                    card.name = line.substring(2);
                } else if (line.startsWith('**–¢–∏–ø:**')) {
                    const typeText = line.substring(7).trim().toLowerCase();
                    if (typeText.includes('—Å—É—â–µ—Å—Ç–≤–æ')) card.type = 'creature';
                    else if (typeText.includes('–∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ')) card.type = 'spell';
                    else if (typeText.includes('–∞—Ä—Ç–µ—Ñ–∞–∫—Ç')) card.type = 'artifact';
                } else if (line.startsWith('**–°—Ç–æ–∏–º–æ—Å—Ç—å:**')) {
                    const match = line.match(/\d+/);
                    if (match) card.cost = parseInt(match[0]);
                } else if (line.startsWith('**–ê—Ç–∞–∫–∞:**')) {
                    const match = line.match(/\d+/);
                    if (match) card.attack = parseInt(match[0]);
                } else if (line.startsWith('**–ó–¥–æ—Ä–æ–≤—å–µ:**')) {
                    const match = line.match(/\d+/);
                    if (match) {
                        card.health = parseInt(match[0]);
                        card.maxHealth = card.health;
                    }
                } else if (line.startsWith('**–ë–æ–Ω—É—Å –∞—Ç–∞–∫–∏:**')) {
                    const match = line.match(/\+(\d+)/);
                    if (match) card.attack = parseInt(match[1]);
                } else if (line.startsWith('**–ë–æ–Ω—É—Å –∑–¥–æ—Ä–æ–≤—å—è:**')) {
                    const match = line.match(/\+(\d+)/);
                    if (match) card.health = parseInt(match[1]);
                } else if (line.startsWith('**–ê–≤–∞—Ç–∞—Ä:**')) {
                    card.avatar = line.substring(10).trim();
                } else if (line.startsWith('**–°–æ–∑–¥–∞—Ç–µ–ª—å:**')) {
                    card.creator = line.substring(13).trim();
                } else if (line === '## –û—Å–æ–±—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏') {
                    i++;
                    while (i < lines.length && lines[i].trim() && !lines[i].startsWith('##')) {
                        if (lines[i].startsWith('- ')) {
                            const ability = lines[i].substring(2).trim();
                            card.abilities.push(ability);
                            
                            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–≤–æ–π—Å—Ç–≤–∞ –∏–∑ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
                            if (ability.includes('–ü—Ä–æ—Ä—ã–≤')) card.canAttack = true;
                        }
                        i++;
                    }
                } else if (line === '## –û–ø–∏—Å–∞–Ω–∏–µ') {
                    i++;
                    const desc = [];
                    while (i < lines.length && lines[i].trim() && !lines[i].startsWith('##')) {
                        desc.push(lines[i]);
                        i++;
                    }
                    card.description = desc.join('\n').trim();
                }
            }
            
            return card;
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç –∏–∑ —Ñ–∞–π–ª–æ–≤
        async function loadCardsFromFiles(fileList, team) {
            const cards = [];
            
            for (const file of fileList) {
                try {
                    const text = await file.text();
                    const card = parseCardFromMarkdown(text, team);
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤–∞—Ç–∞—Ä
                    if (card.avatar) {
                        try {
                            const img = new Image();
                            await new Promise((resolve, reject) => {
                                img.onload = resolve;
                                img.onerror = () => reject(new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏'));
                                img.src = card.avatar;
                            });
                        } catch (error) {
                            card.avatarError = true;
                            console.warn(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞ –¥–ª—è –∫–∞—Ä—Ç—ã ${card.name}:`, card.avatar);
                        }
                    }
                    
                    cards.push(card);
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞:', error);
                    addLog(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–∞—Ä—Ç—ã –∏–∑ —Ñ–∞–π–ª–∞ ${file.name}`, 'attack');
                }
            }
            
            return cards;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–≥—Ä—É–∑–∫–µ
        function updateLoadInfo() {
            elements.teamAInfo.textContent = `–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∫–∞—Ä—Ç: ${gameState.teamA.deck.length}`;
            elements.teamBInfo.textContent = `–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∫–∞—Ä—Ç: ${gameState.teamB.deck.length}`;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        async function initGame() {
            if (gameState.teamA.deck.length === 0 || gameState.teamB.deck.length === 0) {
                addLog('–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–∞—Ä—Ç—ã –¥–ª—è –æ–±–µ–∏—Ö –∫–æ–º–∞–Ω–¥!', 'attack');
                return;
            }
            
            elements.loadingIndicator.style.display = 'flex';
            
            try {
                // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∫–æ–ª–æ–¥—ã
                shuffleArray(gameState.teamA.deck);
                shuffleArray(gameState.teamB.deck);
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
                gameState.currentTurn = 'A';
                gameState.turnNumber = 1;
                gameState.selectedCard = null;
                gameState.gameStarted = true;
                gameState.gameOver = false;
                gameState.totalDamage = 0;
                gameState.totalCardsPlayed = 0;
                
                gameState.teamA.mana = 10;
                gameState.teamA.maxMana = 10;
                gameState.teamA.health = 30;
                gameState.teamA.hand = [];
                gameState.teamA.board = [];
                
                gameState.teamB.mana = 10;
                gameState.teamB.maxMana = 10;
                gameState.teamB.health = 30;
                gameState.teamB.hand = [];
                gameState.teamB.board = [];
                
                gameState.logs = [];
                
                // –†–∞–∑–¥–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã
                for (let i = 0; i < 3; i++) {
                    drawCard('A');
                    drawCard('B');
                }
                
                addLog('–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –ü–µ—Ä–≤—ã–º —Ö–æ–¥–∏—Ç –ö–æ–º–∞–Ω–¥–∞ A', 'turn');
                
                await new Promise(resolve => setTimeout(resolve, 500));
                
                updateUI();
                
            } finally {
                elements.loadingIndicator.style.display = 'none';
            }
        }
        
        // –í–∑—è—Ç–∏–µ –∫–∞—Ä—Ç—ã
        function drawCard(team) {
            const teamObj = team === 'A' ? gameState.teamA : gameState.teamB;
            
            if (teamObj.deck.length > 0) {
                const card = teamObj.deck.pop();
                teamObj.hand.push(card);
                
                addLog(`${team === 'A' ? '–ö–æ–º–∞–Ω–¥–∞ A' : '–ö–æ–º–∞–Ω–¥–∞ B'} –±–µ—Ä–µ—Ç –∫–∞—Ä—Ç—É: ${card.name}`, 'spell');
                return true;
            }
            
            return false;
        }
        
        // –†–∞–∑—ã–≥—Ä—ã–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã
        function playCard(cardId) {
            const currentTeam = gameState.currentTurn;
            const teamObj = currentTeam === 'A' ? gameState.teamA : gameState.teamB;
            
            const cardIndex = teamObj.hand.findIndex(c => c.id === cardId);
            if (cardIndex === -1) return false;
            
            const card = teamObj.hand[cardIndex];
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞–Ω—É
            if (teamObj.mana < card.cost) {
                addLog(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–∞–Ω—ã! –ù—É–∂–Ω–æ ${card.cost}, –µ—Å—Ç—å ${teamObj.mana}`, 'attack');
                return false;
            }
            
            teamObj.mana -= card.cost;
            teamObj.hand.splice(cardIndex, 1);
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∫–∞—Ä—Ç
            if (card.type === 'creature') {
                // –°—É—â–µ—Å—Ç–≤–æ –∏–¥–µ—Ç –Ω–∞ –ø–æ–ª–µ –±–æ—è
                const boardCard = { ...card };
                boardCard.canAttack = boardCard.abilities.some(a => a.includes('–ü—Ä–æ—Ä—ã–≤'));
                teamObj.board.push(boardCard);
                addLog(`${currentTeam === 'A' ? '–ö–æ–º–∞–Ω–¥–∞ A' : '–ö–æ–º–∞–Ω–¥–∞ B'} –ø—Ä–∏–∑—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ: ${card.name}`, 'spell');
                
            } else if (card.type === 'spell') {
                // –ó–∞–∫–ª–∏–Ω–∞–Ω–∏–µ —Å—Ä–∞–∑—É –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
                applySpell(card, currentTeam);
                addLog(`${currentTeam === 'A' ? '–ö–æ–º–∞–Ω–¥–∞ A' : '–ö–æ–º–∞–Ω–¥–∞ B'} –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ: ${card.name}`, 'spell');
                
            } else if (card.type === 'artifact') {
                // –ê—Ä—Ç–µ—Ñ–∞–∫—Ç –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ
                if (teamObj.board.length === 0) {
                    addLog('–ù–µ—Ç —Å—É—â–µ—Å—Ç–≤ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞!', 'attack');
                    teamObj.hand.push(card); // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞—Ä—Ç—É –≤ —Ä—É–∫—É
                    teamObj.mana += card.cost; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–∞–Ω—É
                    return false;
                }
                
                // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–æ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è
                const randomIndex = Math.floor(Math.random() * teamObj.board.length);
                const target = teamObj.board[randomIndex];
                
                target.attack += card.attack;
                target.health += card.health;
                target.maxHealth += card.health;
                
                addLog(`${currentTeam === 'A' ? '–ö–æ–º–∞–Ω–¥–∞ A' : '–ö–æ–º–∞–Ω–¥–∞ B'} –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç ${card.name} –Ω–∞ ${target.name}`, 'artifact');
            }
            
            gameState.totalCardsPlayed++;
            gameState.selectedCard = null;
            return true;
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è
        function applySpell(spell, casterTeam) {
            const targetTeam = casterTeam === 'A' ? gameState.teamB : gameState.teamA;
            const casterTeamObj = casterTeam === 'A' ? gameState.teamA : gameState.teamB;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è
            const desc = spell.description.toLowerCase();
            let isHeal = desc.includes('–∏—Å—Ü–µ–ª') || desc.includes('–ª–µ—á–µ–Ω');
            let isDamage = desc.includes('—É—Ä–æ–Ω') || desc.includes('–∞—Ç–∞–∫') || desc.includes('–ø–æ–≤—Ä–µ–∂–¥');
            
            // –ï—Å–ª–∏ –Ω–µ —è—Å–Ω–æ, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º —É—Ä–æ–Ω
            if (!isHeal && !isDamage) {
                isDamage = true;
            }
            
            if (isHeal) {
                // –ò—Å—Ü–µ–ª–µ–Ω–∏–µ —Å–æ—é–∑–Ω–∏–∫–∞
                if (casterTeamObj.board.length === 0) {
                    // –ï—Å–ª–∏ –Ω–µ—Ç —Å—É—â–µ—Å—Ç–≤, –ª–µ—á–∏–º –≥–µ—Ä–æ—è
                    casterTeamObj.health = Math.min(casterTeamObj.health + spell.attack, 30);
                    addLog(`${spell.name} –∏—Å—Ü–µ–ª—è–µ—Ç –≥–µ—Ä–æ—è –Ω–∞ ${spell.attack} HP`, 'heal');
                } else {
                    // –õ–µ—á–∏–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–æ
                    const randomIndex = Math.floor(Math.random() * casterTeamObj.board.length);
                    const target = casterTeamObj.board[randomIndex];
                    target.health = Math.min(target.health + spell.attack, target.maxHealth);
                    addLog(`${spell.name} –∏—Å—Ü–µ–ª—è–µ—Ç ${target.name} –Ω–∞ ${spell.attack} HP`, 'heal');
                }
            } else if (isDamage) {
                // –£—Ä–æ–Ω –≤—Ä–∞–≥—É
                if (targetTeam.board.length === 0) {
                    // –ï—Å–ª–∏ –Ω–µ—Ç —Å—É—â–µ—Å—Ç–≤, –±—å–µ–º –≥–µ—Ä–æ—è
                    targetTeam.health -= spell.attack;
                    gameState.totalDamage += spell.attack;
                    addLog(`${spell.name} –Ω–∞–Ω–æ—Å–∏—Ç ${spell.attack} —É—Ä–æ–Ω–∞ –≥–µ—Ä–æ—é`, 'attack');
                    
                    if (targetTeam.health <= 0) {
                        targetTeam.health = 0;
                        endGame(casterTeam);
                    }
                } else {
                    // –ë—å–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–æ
                    const randomIndex = Math.floor(Math.random() * targetTeam.board.length);
                    const target = targetTeam.board[randomIndex];
                    
                    let damage = spell.attack;
                    if (target.abilities.some(a => a.includes('–©–∏—Ç'))) {
                        damage = Math.max(0, damage - 1);
                        addLog(`–©–∏—Ç —É–º–µ–Ω—å—à–∞–µ—Ç —É—Ä–æ–Ω –Ω–∞ 1`, 'spell');
                    }
                    
                    target.health -= damage;
                    gameState.totalDamage += damage;
                    addLog(`${spell.name} –Ω–∞–Ω–æ—Å–∏—Ç ${damage} —É—Ä–æ–Ω–∞ ${target.name}`, 'attack');
                    
                    if (target.health <= 0) {
                        targetTeam.board.splice(randomIndex, 1);
                        addLog(`${target.name} —É–Ω–∏—á—Ç–æ–∂–µ–Ω!`, 'attack');
                    }
                }
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞—Ç–∞–∫–∞
        function autoAttack() {
            const currentTeam = gameState.currentTurn;
            const attackerTeam = currentTeam === 'A' ? gameState.teamA : gameState.teamB;
            const targetTeam = currentTeam === 'A' ? gameState.teamB : gameState.teamA;
            
            let attacked = false;
            
            // –ê—Ç–∞–∫—É—é—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∞—Ç–∞–∫–æ–≤–∞—Ç—å
            attackerTeam.board.forEach(attacker => {
                if (attacker.canAttack) {
                    if (targetTeam.board.length > 0) {
                        // –ê—Ç–∞–∫—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –≤—Ä–∞–∂–µ—Å–∫–æ–µ —Å—É—â–µ—Å—Ç–≤–æ
                        const randomIndex = Math.floor(Math.random() * targetTeam.board.length);
                        const target = targetTeam.board[randomIndex];
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å
                        if (target.abilities.some(a => a.includes('–°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å'))) {
                            addLog(`${target.name} —Å–∫—Ä—ã—Ç –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∞—Ç–∞–∫–æ–≤–∞–Ω`, 'spell');
                            return;
                        }
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–≤–æ–∫–∞—Ü–∏—é
                        const tauntCreatures = targetTeam.board.filter(c => 
                            c.abilities.some(a => a.includes('–ü—Ä–æ–≤–æ–∫–∞—Ü–∏—è'))
                        );
                        
                        let finalTarget = target;
                        if (tauntCreatures.length > 0) {
                            // –ê—Ç–∞–∫—É–µ–º —Å—É—â–µ—Å—Ç–≤–æ —Å –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–µ–π
                            finalTarget = tauntCreatures[Math.floor(Math.random() * tauntCreatures.length)];
                        }
                        
                        // –†–∞—Å—á–µ—Ç —É—Ä–æ–Ω–∞
                        let damage = attacker.attack;
                        if (finalTarget.abilities.some(a => a.includes('–©–∏—Ç'))) {
                            damage = Math.max(0, damage - 1);
                        }
                        
                        // –ö–æ–Ω—Ç—Ä–∞—Ç–∞–∫–∞
                        let counterDamage = 0;
                        if (finalTarget.health > 0) {
                            counterDamage = finalTarget.attack;
                            if (attacker.abilities.some(a => a.includes('–©–∏—Ç'))) {
                                counterDamage = Math.max(0, counterDamage - 1);
                            }
                        }
                        
                        // –ü—Ä–∏–º–µ–Ω—è–µ–º —É—Ä–æ–Ω
                        finalTarget.health -= damage;
                        if (finalTarget.health <= 0) {
                            const targetIndex = targetTeam.board.indexOf(finalTarget);
                            if (targetIndex !== -1) {
                                targetTeam.board.splice(targetIndex, 1);
                            }
                            addLog(`${attacker.name} —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç ${finalTarget.name}!`, 'attack');
                        } else {
                            addLog(`${attacker.name} –∞—Ç–∞–∫—É–µ—Ç ${finalTarget.name} (${damage} —É—Ä–æ–Ω–∞)`, 'attack');
                            
                            // –ö–æ–Ω—Ç—Ä–∞—Ç–∞–∫–∞
                            if (counterDamage > 0) {
                                attacker.health -= counterDamage;
                                if (attacker.health <= 0) {
                                    const attackerIndex = attackerTeam.board.indexOf(attacker);
                                    if (attackerIndex !== -1) {
                                        attackerTeam.board.splice(attackerIndex, 1);
                                    }
                                    addLog(`${finalTarget.name} –∫–æ–Ω—Ç—Ä–∞—Ç–∞–∫—É–µ—Ç –∏ —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç ${attacker.name}!`, 'attack');
                                } else {
                                    addLog(`${finalTarget.name} –∫–æ–Ω—Ç—Ä–∞—Ç–∞–∫—É–µ—Ç (${counterDamage} —É—Ä–æ–Ω–∞)`, 'attack');
                                }
                            }
                        }
                        
                        gameState.totalDamage += damage + counterDamage;
                        attacked = true;
                        
                    } else {
                        // –ê—Ç–∞–∫—É–µ–º –≥–µ—Ä–æ—è, –µ—Å–ª–∏ –Ω–µ—Ç —Å—É—â–µ—Å—Ç–≤
                        targetTeam.health -= attacker.attack;
                        gameState.totalDamage += attacker.attack;
                        addLog(`${attacker.name} –∞—Ç–∞–∫—É–µ—Ç –≥–µ—Ä–æ—è (${attacker.attack} —É—Ä–æ–Ω–∞)`, 'attack');
                        
                        if (targetTeam.health <= 0) {
                            targetTeam.health = 0;
                            endGame(currentTeam);
                        }
                        
                        attacked = true;
                    }
                    
                    attacker.canAttack = false;
                }
            });
            
            return attacked;
        }
        
        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ö–æ–¥–∞
        function endTurn() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞—Ç–∞–∫
            const currentTeam = gameState.currentTurn;
            const teamObj = currentTeam === 'A' ? gameState.teamA : gameState.teamB;
            
            teamObj.board.forEach(creature => {
                creature.canAttack = true;
            });
            
            // –ü–µ—Ä–µ–¥–∞–µ–º —Ö–æ–¥
            gameState.currentTurn = gameState.currentTurn === 'A' ? 'B' : 'A';
            
            if (gameState.currentTurn === 'A') {
                gameState.turnNumber++;
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –º–∞–Ω—É
            const newTeam = gameState.currentTurn === 'A' ? gameState.teamA : gameState.teamB;
            newTeam.maxMana = Math.min(newTeam.maxMana + 1, 10);
            newTeam.mana = newTeam.maxMana;
            
            // –ë–µ—Ä–µ–º –∫–∞—Ä—Ç—É
            drawCard(gameState.currentTurn);
            
            addLog(`–•–æ–¥ ${gameState.turnNumber}: —Ç–µ–ø–µ—Ä—å —Ö–æ–¥–∏—Ç ${gameState.currentTurn === 'A' ? '–ö–æ–º–∞–Ω–¥–∞ A' : '–ö–æ–º–∞–Ω–¥–∞ B'}`, 'turn');
            
            gameState.selectedCard = null;
        }
        
        // –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã
        function endGame(winner) {
            gameState.gameOver = true;
            gameState.gameStarted = false;
            
            const winnerName = winner === 'A' ? '–ö–æ–º–∞–Ω–¥–∞ A' : '–ö–æ–º–∞–Ω–¥–∞ B';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–±–µ–¥—ã
            elements.victoryTeam.textContent = winnerName;
            elements.victoryTeam.className = winner === 'A' ? 'victory-team victory-a' : 'victory-team victory-b';
            elements.victoryTurn.textContent = gameState.turnNumber;
            elements.victoryCards.textContent = gameState.totalCardsPlayed;
            elements.victoryDamage.textContent = gameState.totalDamage;
            
            addLog(`üéâ ${winnerName} –ø–æ–±–µ–∂–¥–∞–µ—Ç! üéâ`, 'turn');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã
            setTimeout(() => {
                elements.victoryScreen.style.display = 'flex';
            }, 1000);
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–∞—Ä—Ç—ã
        function createCardElement(card, location) {
            const div = document.createElement('div');
            div.className = `card card-${card.type}`;
            div.dataset.id = card.id;
            div.dataset.location = location;
            
            if (gameState.selectedCard === card.id) {
                div.classList.add('selected');
            }
            
            if (location === 'hand' && gameState.gameStarted) {
                const currentTeam = gameState.currentTurn;
                const teamObj = currentTeam === 'A' ? gameState.teamA : gameState.teamB;
                
                if (teamObj.mana < card.cost) {
                    div.classList.add('disabled');
                }
            }
            
            // –ê–≤–∞—Ç–∞—Ä –∏–ª–∏ placeholder
            let avatarHtml = '';
            if (card.avatar && !card.avatarError) {
                avatarHtml = `<img class="card-avatar" src="${card.avatar}" alt="${card.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">`;
            }
            
            const placeholderIcon = card.type === 'creature' ? 'fa-dragon' : 
                                  card.type === 'spell' ? 'fa-fire' : 'fa-gem';
            
            div.innerHTML = `
                ${avatarHtml}
                <div class="avatar-placeholder" style="${card.avatar && !card.avatarError ? 'display:none' : ''}">
                    <i class="fas ${placeholderIcon}"></i>
                </div>
                ${card.avatarError ? '<div class="avatar-error">–û—à–∏–±–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞</div>' : ''}
                
                <div class="card-type type-${card.type}">
                    ${card.type === 'creature' ? '–°—É—â–µ—Å—Ç–≤–æ' : card.type === 'spell' ? '–ó–∞–∫–ª–∏–Ω–∞–Ω–∏–µ' : '–ê—Ä—Ç–µ—Ñ–∞–∫—Ç'}
                </div>
                
                ${location === 'hand' ? `<div class="card-cost">${card.cost}</div>` : ''}
                
                <div class="card-name">${card.name}</div>
                
                ${card.type !== 'spell' ? `
                    <div class="card-stats">
                        <div class="stat-attack">
                            <i class="fas fa-fist-raised"></i> ${card.attack}
                        </div>
                        <div class="stat-health">
                            <i class="fas fa-heart"></i> ${card.health}
                        </div>
                    </div>
                ` : ''}
                
                ${card.abilities.length > 0 ? `
                    <div class="card-abilities">
                        ${card.abilities.slice(0, 3).map(a => 
                            `<span class="ability-tag">${a.split(' ')[0]}</span>`
                        ).join('')}
                    </div>
                ` : ''}
                
                ${location === 'board' && card.canAttack ? '<div class="card-can-attack"></div>' : ''}
            `;
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            div.addEventListener('click', () => handleCardClick(card.id, location));
            div.addEventListener('dblclick', () => showCardDetails(card));
            
            return div;
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –∫–∞—Ä—Ç–µ
        function handleCardClick(cardId, location) {
            if (!gameState.gameStarted || gameState.gameOver) return;
            
            const currentTeam = gameState.currentTurn;
            const teamObj = currentTeam === 'A' ? gameState.teamA : gameState.teamB;
            
            if (location === 'hand') {
                // –ö–∞—Ä—Ç–∞ –≤ —Ä—É–∫–µ
                if (gameState.selectedCard === cardId) {
                    gameState.selectedCard = null;
                } else {
                    const card = teamObj.hand.find(c => c.id === cardId);
                    if (card && teamObj.mana >= card.cost) {
                        gameState.selectedCard = cardId;
                    }
                }
            } else if (location === 'board') {
                // –ö–∞—Ä—Ç–∞ –Ω–∞ –ø–æ–ª–µ
                if (gameState.selectedCard) {
                    // –ï—Å–ª–∏ —É–∂–µ –≤—ã–±—Ä–∞–Ω–∞ –∫–∞—Ä—Ç–∞ –¥–ª—è –∞—Ç–∞–∫–∏
                    const selectedCard = teamObj.board.find(c => c.id === gameState.selectedCard);
                    if (selectedCard && selectedCard.canAttack) {
                        // –≠—Ç–æ –∞—Ç–∞–∫–∞
                        gameState.selectedCard = null;
                    }
                } else {
                    // –í—ã–±–∏—Ä–∞–µ–º –∫–∞—Ä—Ç—É –¥–ª—è –∞—Ç–∞–∫–∏
                    const card = teamObj.board.find(c => c.id === cardId);
                    if (card && card.canAttack) {
                        gameState.selectedCard = cardId;
                    }
                }
            }
            
            updateUI();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–∞—Ä—Ç—ã
        function showCardDetails(card) {
            elements.modalCardName.textContent = card.name;
            elements.modalCardCost.textContent = card.cost;
            elements.modalCardAttack.textContent = card.attack;
            elements.modalCardHealth.textContent = card.health;
            elements.modalCardType.textContent = card.type === 'creature' ? '–°—É—â–µ—Å—Ç–≤–æ' : 
                                               card.type === 'spell' ? '–ó–∞–∫–ª–∏–Ω–∞–Ω–∏–µ' : '–ê—Ä—Ç–µ—Ñ–∞–∫—Ç';
            elements.modalCardAbilities.innerHTML = card.abilities.length > 0 
                ? card.abilities.map(a => `<div>‚Ä¢ ${a}</div>`).join('')
                : '–ù–µ—Ç';
            elements.modalCardDescription.textContent = card.description;
            elements.modalCardCreator.textContent = card.creator;
            
            // –ê–≤–∞—Ç–∞—Ä
            elements.modalAvatarContainer.innerHTML = '';
            if (card.avatar && !card.avatarError) {
                const img = document.createElement('img');
                img.src = card.avatar;
                img.style.width = '100%';
                img.style.height = '200px';
                img.style.objectFit = 'cover';
                img.style.borderRadius = '10px';
                img.onerror = () => {
                    elements.modalAvatarContainer.innerHTML = `
                        <div style="height: 200px; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 10px; color: rgba(255,255,255,0.3);">
                            <i class="fas fa-${card.type === 'creature' ? 'dragon' : card.type === 'spell' ? 'fire' : 'gem'} fa-3x"></i>
                        </div>
                    `;
                };
                elements.modalAvatarContainer.appendChild(img);
            } else {
                elements.modalAvatarContainer.innerHTML = `
                    <div style="height: 200px; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 10px; color: rgba(255,255,255,0.3);">
                        <i class="fas fa-${card.type === 'creature' ? 'dragon' : card.type === 'spell' ? 'fire' : 'gem'} fa-3x"></i>
                    </div>
                `;
            }
            
            elements.cardModal.style.display = 'flex';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        function updateUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ–º–∞–Ω–¥
            elements.teamAMana.textContent = gameState.teamA.mana;
            elements.teamAHealth.textContent = gameState.teamA.health;
            elements.teamBMana.textContent = gameState.teamB.mana;
            elements.teamBHealth.textContent = gameState.teamB.health;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ö–æ–¥–∞
            elements.currentTeam.textContent = gameState.currentTurn === 'A' ? '–ö–æ–º–∞–Ω–¥–∞ A' : '–ö–æ–º–∞–Ω–¥–∞ B';
            elements.currentTeam.className = gameState.currentTurn === 'A' ? 'turn-team turn-a' : 'turn-team turn-b';
            elements.turnNumber.textContent = `–•–æ–¥ ${gameState.turnNumber}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞—Ä—Ç—ã
            updateCardsContainer(elements.teamAHand, gameState.teamA.hand, 'hand');
            updateCardsContainer(elements.teamABoard, gameState.teamA.board, 'board');
            updateCardsContainer(elements.teamBHand, gameState.teamB.hand, 'hand');
            updateCardsContainer(elements.teamBBoard, gameState.teamB.board, 'board');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
            updateButtonsState();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –∫–∞—Ä—Ç–∞–º–∏
        function updateCardsContainer(container, cards, location) {
            container.innerHTML = '';
            
            if (cards.length === 0) {
                const emptyMsg = document.createElement('div');
                emptyMsg.className = 'empty-message';
                emptyMsg.textContent = location === 'hand' ? '–†—É–∫–∞ –ø—É—Å—Ç–∞' : '–ü–æ–ª–µ –±–æ—è –ø—É—Å—Ç–æ';
                container.appendChild(emptyMsg);
                return;
            }
            
            cards.forEach(card => {
                const cardElement = createCardElement(card, location);
                container.appendChild(cardElement);
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫
        function updateButtonsState() {
            const gameActive = gameState.gameStarted && !gameState.gameOver;
            
            elements.endTurnBtn.disabled = !gameActive;
            elements.drawCardBtn.disabled = !gameActive || 
                (gameState.currentTurn === 'A' ? gameState.teamA.deck.length === 0 : gameState.teamB.deck.length === 0);
            
            if (gameActive && gameState.selectedCard) {
                const currentTeam = gameState.currentTurn;
                const teamObj = currentTeam === 'A' ? gameState.teamA : gameState.teamB;
                const card = teamObj.hand.find(c => c.id === gameState.selectedCard);
                
                if (card && teamObj.mana >= card.cost) {
                    elements.playCardBtn.disabled = false;
                } else {
                    elements.playCardBtn.disabled = true;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –∞—Ç–∞–∫–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ–π
                const boardCard = teamObj.board.find(c => c.id === gameState.selectedCard);
                elements.attackBtn.disabled = !(boardCard && boardCard.canAttack);
            } else {
                elements.playCardBtn.disabled = true;
                elements.attackBtn.disabled = true;
            }
            
            elements.startGameBtn.disabled = gameState.teamA.deck.length === 0 || gameState.teamB.deck.length === 0;
        }
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
        function enableTestMode() {
            if (gameState.teamA.deck.length === 0 || gameState.teamB.deck.length === 0) {
                addLog('–°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–∞—Ä—Ç—ã!', 'attack');
                return;
            }
            
            gameState.teamA.mana = 99;
            gameState.teamB.mana = 99;
            gameState.teamA.health = 100;
            gameState.teamB.health = 100;
            
            addLog('–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!', 'spell');
            updateUI();
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –∫–∞—Ä—Ç
        function clearCards() {
            gameState.teamA.deck = [];
            gameState.teamB.deck = [];
            elements.teamAInput.value = '';
            elements.teamBInput.value = '';
            
            updateLoadInfo();
            resetGame();
            addLog('–í—Å–µ –∫–∞—Ä—Ç—ã –æ—á–∏—â–µ–Ω—ã', 'turn');
        }
        
        // –°–±—Ä–æ—Å –∏–≥—Ä—ã
        function resetGame() {
            gameState.currentTurn = 'A';
            gameState.turnNumber = 1;
            gameState.selectedCard = null;
            gameState.gameStarted = false;
            gameState.gameOver = false;
            gameState.totalDamage = 0;
            gameState.totalCardsPlayed = 0;
            
            gameState.teamA.mana = 10;
            gameState.teamA.maxMana = 10;
            gameState.teamA.health = 30;
            gameState.teamA.hand = [];
            gameState.teamA.board = [];
            
            gameState.teamB.mana = 10;
            gameState.teamB.maxMana = 10;
            gameState.teamB.health = 30;
            gameState.teamB.hand = [];
            gameState.teamB.board = [];
            
            gameState.logs = [
                { message: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ BattleScript Core!', type: 'turn', timestamp: new Date().toLocaleTimeString() },
                { message: '–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–∞—Ä—Ç—ã –∫–æ–º–∞–Ω–¥ –∏ –Ω–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É', type: 'normal', timestamp: new Date().toLocaleTimeString() }
            ];
            
            elements.victoryScreen.style.display = 'none';
            updateUI();
            updateLogUI();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–º–æ—â—å
        function showHelp() {
            addLog('=== –ü–æ–º–æ—â—å –ø–æ –∏–≥—Ä–µ ===', 'turn');
            addLog('1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ .md —Ñ–∞–π–ª—ã –∫–∞—Ä—Ç –¥–ª—è –æ–±–µ–∏—Ö –∫–æ–º–∞–Ω–¥', 'spell');
            addLog('2. –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É"', 'spell');
            addLog('3. –°—É—â–µ—Å—Ç–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞—Ç–∞–∫—É—é—Ç –≤—Ä–∞–≥–æ–≤', 'spell');
            addLog('4. –ó–∞–∫–ª–∏–Ω–∞–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ —Ä–æ–∑—ã–≥—Ä—ã—à–µ', 'spell');
            addLog('5. –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —É–ª—É—á—à–∞—é—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ—é–∑–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–æ', 'spell');
            addLog('6. –ù–∞–∂–º–∏—Ç–µ "–ê–≤—Ç–æ-–∞—Ç–∞–∫–∞" –¥–ª—è –∞—Ç–∞–∫–∏ –≤—Å–µ–º–∏ —Å—É—â–µ—Å—Ç–≤–∞–º–∏', 'spell');
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
        function initEventListeners() {
            // –ö–Ω–æ–ø–∫–∏ –∏–≥—Ä—ã
            elements.endTurnBtn.addEventListener('click', () => {
                if (gameState.gameStarted && !gameState.gameOver) {
                    endTurn();
                    updateUI();
                }
            });
            
            elements.drawCardBtn.addEventListener('click', () => {
                if (gameState.gameStarted && !gameState.gameOver) {
                    drawCard(gameState.currentTurn);
                    updateUI();
                }
            });
            
            elements.playCardBtn.addEventListener('click', () => {
                if (gameState.gameStarted && !gameState.gameOver && gameState.selectedCard) {
                    if (playCard(gameState.selectedCard)) {
                        updateUI();
                    }
                }
            });
            
            elements.attackBtn.addEventListener('click', () => {
                if (gameState.gameStarted && !gameState.gameOver) {
                    if (autoAttack()) {
                        updateUI();
                    }
                }
            });
            
            elements.restartBtn.addEventListener('click', resetGame);
            elements.startGameBtn.addEventListener('click', initGame);
            elements.testModeBtn.addEventListener('click', enableTestMode);
            elements.clearCardsBtn.addEventListener('click', clearCards);
            elements.helpBtn.addEventListener('click', showHelp);
            elements.newGameBtn.addEventListener('click', () => {
                elements.victoryScreen.style.display = 'none';
                resetGame();
            });
            
            // –§–∞–π–ª–æ–≤—ã–µ –∏–Ω–ø—É—Ç—ã
            elements.teamAInput.addEventListener('change', async (e) => {
                const files = Array.from(e.target.files);
                if (files.length > 0) {
                    elements.loadingIndicator.style.display = 'flex';
                    gameState.teamA.deck = await loadCardsFromFiles(files, 'A');
                    updateLoadInfo();
                    elements.loadingIndicator.style.display = 'none';
                    addLog(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${files.length} –∫–∞—Ä—Ç –¥–ª—è –ö–æ–º–∞–Ω–¥—ã A`, 'spell');
                }
            });
            
            elements.teamBInput.addEventListener('change', async (e) => {
                const files = Array.from(e.target.files);
                if (files.length > 0) {
                    elements.loadingIndicator.style.display = 'flex';
                    gameState.teamB.deck = await loadCardsFromFiles(files, 'B');
                    updateLoadInfo();
                    elements.loadingIndicator.style.display = 'none';
                    addLog(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${files.length} –∫–∞—Ä—Ç –¥–ª—è –ö–æ–º–∞–Ω–¥—ã B`, 'spell');
                }
            });
            
            // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
            document.getElementById('closeModalBtn').addEventListener('click', () => {
                elements.cardModal.style.display = 'none';
            });
            
            window.addEventListener('click', (e) => {
                if (e.target === elements.cardModal) {
                    elements.cardModal.style.display = 'none';
                }
                if (e.target === elements.victoryScreen) {
                    elements.victoryScreen.style.display = 'none';
                }
            });
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            initEventListeners();
            resetGame();
        });
    </script>
</body>
</html>