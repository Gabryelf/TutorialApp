<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞–π–¥–∏ –æ—à–∏–±–∫—É –≤ –ë–∞–∑–µ –î–∞–Ω–Ω—ã—Ö | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --accent: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-card: #252547;
            --bg-accent: #2d2d5a;
            
            --text-primary: #ffffff;
            --text-secondary: #a0a0c0;
            --text-accent: #d0d0ff;
            
            --border-primary: #333366;
            --border-accent: #404080;
            
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --shadow-hover: 0 12px 48px rgba(0, 0, 0, 0.6);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .app-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: var(--bg-card);
            border-radius: 20px;
            border: 2px solid var(--border-primary);
            box-shadow: var(--shadow);
        }

        .app-title {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .app-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Progress */
        .progress-container {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid var(--border-primary);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-accent);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 4px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            font-weight: 600;
            color: var(--text-secondary);
        }

        /* Game Area */
        .game-area {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
            margin-bottom: 30px;
        }

        /* Table Container */
        .table-container {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--border-primary);
            box-shadow: var(--shadow);
        }

        .table-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-accent);
            text-align: center;
        }

        .table-description {
            color: var(--text-secondary);
            margin-bottom: 25px;
            text-align: center;
            font-weight: 500;
        }

        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-secondary);
            border-radius: 10px;
            overflow: hidden;
        }

        .data-table th {
            background: var(--primary);
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            border-right: 1px solid var(--primary-dark);
        }

        .data-table th:last-child {
            border-right: none;
        }

        .data-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border-primary);
            border-right: 1px solid var(--border-primary);
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .data-table td:last-child {
            border-right: none;
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover td {
            background: var(--bg-accent);
        }

        .error-cell {
            background: rgba(239, 68, 68, 0.1) !important;
            border: 1px solid var(--error) !important;
            cursor: pointer;
            position: relative;
        }

        .error-cell:hover {
            background: rgba(239, 68, 68, 0.2) !important;
            transform: scale(1.02);
        }

        .error-cell.selected {
            background: rgba(239, 68, 68, 0.3) !important;
            box-shadow: 0 0 0 2px var(--error);
        }

        .error-marker {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--error);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
        }

        /* Controls Panel */
        .controls-panel {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--border-primary);
            box-shadow: var(--shadow);
        }

        .panel-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-accent);
        }

        .selected-cell-info {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid var(--border-primary);
        }

        .cell-coordinates {
            font-weight: 600;
            color: var(--text-accent);
            margin-bottom: 10px;
        }

        .cell-value {
            color: var(--text-secondary);
            font-family: monospace;
            background: var(--bg-primary);
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid var(--border-primary);
        }

        .error-types {
            margin-bottom: 25px;
        }

        .error-type-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .error-buttons {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }

        .error-btn {
            background: var(--bg-accent);
            border: 2px solid var(--border-primary);
            padding: 12px 15px;
            border-radius: 8px;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .error-btn:hover {
            background: var(--primary);
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .error-btn.selected {
            background: var(--primary);
            border-color: var(--primary);
            box-shadow: 0 0 0 2px var(--accent);
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--accent), #059669);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Feedback */
        .feedback-container {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--border-primary);
            box-shadow: var(--shadow);
            margin-top: 20px;
        }

        .feedback-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-accent);
        }

        .feedback-content {
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .feedback-correct {
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid var(--accent);
            color: var(--accent);
        }

        .feedback-incorrect {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--error);
            color: var(--error);
        }

        .next-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .next-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        /* Results */
        .results-container {
            text-align: center;
            padding: 40px;
        }

        .results-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .results-score {
            font-size: 3rem;
            font-weight: 800;
            color: var(--accent);
            margin: 20px 0;
        }

        .restart-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .restart-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        /* Utilities */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mb-20 {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="app-header">
            <h1 class="app-title">üîç –ù–∞–π–¥–∏ –æ—à–∏–±–∫—É –≤ –ë–∞–∑–µ –î–∞–Ω–Ω—ã—Ö</h1>
            <p class="app-subtitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä –ø–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö</p>
        </div>

        <!-- Progress -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-info">
                <span id="progressText">–¢–∞–±–ª–∏—Ü–∞ 1 –∏–∑ 5</span>
                <span id="progressPercent">0%</span>
            </div>
        </div>

        <!-- Game Area -->
        <div class="game-area" id="gameArea">
            <!-- Table Container -->
            <div class="table-container">
                <h2 class="table-title" id="tableTitle">–í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–ø–µ—Ä–µ–º–µ—à–∫—É</h2>
                <p class="table-description" id="tableDescription">–ù–∞–π–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ –≤ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∏—Ö —Ç–∏–ø</p>
                
                <div class="table-wrapper">
                    <table class="data-table" id="dataTable">
                        <!-- Table content will be generated by JavaScript -->
                    </table>
                </div>
            </div>

            <!-- Controls Panel -->
            <div class="controls-panel">
                <h3 class="panel-title">üéØ –í—ã–±–µ—Ä–∏—Ç–µ –æ—à–∏–±–∫—É</h3>
                
                <div class="selected-cell-info" id="selectedCellInfo">
                    <div class="cell-coordinates">–í—ã–±–µ—Ä–∏—Ç–µ —è—á–µ–π–∫—É —Å –æ—à–∏–±–∫–æ–π</div>
                    <div class="cell-value">-</div>
                </div>

                <div class="error-types">
                    <div class="error-type-title">–¢–∏–ø—ã –æ—à–∏–±–æ–∫:</div>
                    <div class="error-buttons" id="errorButtons">
                        <button class="error-btn" data-error-type="atomicity">
                            üö´ –ù–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏
                        </button>
                        <button class="error-btn" data-error-type="redundancy">
                            üîÑ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                        </button>
                        <button class="error-btn" data-error-type="integrity">
                            üõ°Ô∏è –ù–∞—Ä—É—à–µ–Ω–∏–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
                        </button>
                        <button class="error-btn" data-error-type="normalization">
                            üèóÔ∏è –ù–∞—Ä—É—à–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
                        </button>
                        <button class="error-btn" data-error-type="constraint">
                            ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫
                        </button>
                    </div>
                </div>

                <button class="submit-btn" id="submitBtn" disabled>
                    ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—ã–±–æ—Ä
                </button>
            </div>
        </div>

        <!-- Feedback -->
        <div class="feedback-container hidden" id="feedbackContainer">
            <h3 class="feedback-title">–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏</h3>
            <div class="feedback-content" id="feedbackContent">
                <!-- Feedback content will be filled by JavaScript -->
            </div>
            <button class="next-btn" id="nextBtn">–°–ª–µ–¥—É—é—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ ‚Üí</button>
        </div>

        <!-- Results -->
        <div class="results-container hidden" id="resultsContainer">
            <h2 class="results-title">üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
            <p class="app-subtitle mb-20">–í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è</p>
            <div class="results-score" id="finalScore">0/5</div>
            <p id="resultsMessage">–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –í—ã —Ö–æ—Ä–æ—à–æ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç–µ—Å—å –≤ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö.</p>
            <button class="restart-btn" id="restartBtn">
                <i class="fas fa-redo"></i> –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ
            </button>
        </div>
    </div>

    <script>
        class DatabaseErrorGame {
            constructor() {
                this.currentTable = 0;
                this.totalTables = 5;
                this.score = 0;
                this.selectedCell = null;
                this.selectedErrorType = null;
                this.tables = [];
                
                this.init();
            }

            init() {
                this.createTables();
                this.bindEvents();
                this.loadTable(this.currentTable);
                this.updateProgress();
            }

            createTables() {
                this.tables = [
                    {
                        title: "–í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–ø–µ—Ä–µ–º–µ—à–∫—É",
                        description: "–ù–∞–π–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ –≤ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ, –≥–¥–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ",
                        headers: ["ID", "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—É–¥–µ–Ω—Ç–µ", "–ö—É—Ä—Å—ã", "–û—Ü–µ–Ω–∫–∏", "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å", "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ"],
                        data: [
                            [1, "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω; ivan@mail.com; IT-101", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –ê–ª–≥–æ—Ä–∏—Ç–º—ã, –°–µ—Ç–∏", "5,4,5", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.; petrov@college.ru", "–ü–Ω 9:00, –í—Ç 11:00"],
                            [2, "–ü–µ—Ç—Ä–æ–≤–∞ –ú–∞—Ä–∏—è; maria@mail.com; IT-101", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "4,5", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.; petrov@college.ru", "–ü–Ω 9:00, –°—Ä 10:00"],
                            [3, "–°–∏–¥–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–µ–π; alex@mail.com; IT-102", "–ê–ª–≥–æ—Ä–∏—Ç–º—ã, –§–∏–∑–∏–∫–∞", "5,3", "–°–∏–¥–æ—Ä–æ–≤ –°.–°.; sidorov@college.ru", "–í—Ç 14:00, –ß—Ç 16:00"]
                        ],
                        errors: [
                            { cell: "1-1", type: "atomicity", description: "–§–ò–û, email –∏ –≥—Ä—É–ø–ø–∞ –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ" },
                            { cell: "1-2", type: "atomicity", description: "–°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é" },
                            { cell: "1-3", type: "atomicity", description: "–°–ø–∏—Å–æ–∫ –æ—Ü–µ–Ω–æ–∫ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é" },
                            { cell: "1-4", type: "redundancy", description: "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è" },
                            { cell: "2-4", type: "redundancy", description: "–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ" }
                        ]
                    },
                    {
                        title: "–°—Ç—É–¥–µ–Ω—Ç—ã —Å –ª–∏—à–Ω–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π", 
                        description: "–ù–∞–π–¥–∏—Ç–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ",
                        headers: ["ID", "–ò–º—è", "–ì—Ä—É–ø–ø–∞", "–ö—É—Ä–∞—Ç–æ—Ä –≥—Ä—É–ø–ø—ã", "–ö–∞—Ñ–µ–¥—Ä–∞", "–ö—É—Ä—Å 1", "–û—Ü–µ–Ω–∫–∞ 1", "–ö—É—Ä—Å 2", "–û—Ü–µ–Ω–∫–∞ 2", "–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª"],
                        data: [
                            [1, "–ò–≤–∞–Ω", "IT-101", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö", 5, "–ê–ª–≥–æ—Ä–∏—Ç–º—ã", 4, 4.5],
                            [2, "–ú–∞—Ä–∏—è", "IT-101", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö", 4, "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞", 5, 4.5],
                            [3, "–ü–µ—Ç—Ä", "IT-102", "–°–∏–¥–æ—Ä–æ–≤ –°.–°.", "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö", 5, "–§–∏–∑–∏–∫–∞", 3, 4.0]
                        ],
                        errors: [
                            { cell: "1-3", type: "normalization", description: "–ö—É—Ä–∞—Ç–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥—Ä—É–ø–ø—ã, –∞ –Ω–µ –æ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞" },
                            { cell: "1-4", type: "normalization", description: "–ö–∞—Ñ–µ–¥—Ä–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥—Ä—É–ø–ø—ã" },
                            { cell: "1-9", type: "constraint", description: "–í—ã—á–∏—Å–ª—è–µ–º–æ–µ –ø–æ–ª–µ (–º–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å)" },
                            { cell: "1-5", type: "atomicity", description: "–ñ–µ—Å—Ç–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∫—É—Ä—Å–æ–≤" }
                        ]
                    },
                    {
                        title: "–û—Ü–µ–Ω–∫–∏ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫",
                        description: "–ù–∞–π–¥–∏—Ç–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö",
                        headers: ["ID", "–°—Ç—É–¥–µ–Ω—Ç", "–ö—É—Ä—Å", "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å", "–û—Ü–µ–Ω–∫–∞", "–î–∞—Ç–∞"],
                        data: [
                            [1, "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", 5, "2024-01-15"],
                            [2, "–ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", 4, "2024-01-15"],
                            [3, "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω", "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫—É—Ä—Å", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", 3, "2024-01-16"],
                            [4, "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", 6, "2024-01-17"],
                            [5, "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", 5, "2024-02-30"]
                        ],
                        errors: [
                            { cell: "2-2", type: "integrity", description: "–ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å—Ç—É–¥–µ–Ω—Ç" },
                            { cell: "3-3", type: "integrity", description: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫—É—Ä—Å" },
                            { cell: "4-5", type: "constraint", description: "–û—Ü–µ–Ω–∫–∞ –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 2-5" },
                            { cell: "5-6", type: "constraint", description: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –¥–∞—Ç–∞" }
                        ]
                    },
                    {
                        title: "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è–º–∏",
                        description: "–ù–∞–π–¥–∏—Ç–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã–µ –¥–∞–Ω–Ω—ã–µ",
                        headers: ["ID", "–ì—Ä—É–ø–ø–∞", "–ö—É—Ä—Å", "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å", "–ê—É–¥–∏—Ç–æ—Ä–∏—è", "–ö–æ—Ä–ø—É—Å", "–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏", "–ù–æ–º–µ—Ä –¥–Ω—è", "–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞", "–í—Ä–µ–º—è –∫–æ–Ω—Ü–∞"],
                        data: [
                            [1, "IT-101", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", "301", "–ì–ª–∞–≤–Ω—ã–π", "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", 2, "09:00", "08:30"],
                            [2, "IT-101", "–ê–ª–≥–æ—Ä–∏—Ç–º—ã", "–°–∏–¥–æ—Ä–æ–≤ –°.–°.", "301", "–ì–ª–∞–≤–Ω—ã–π", "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", 1, "09:00", "10:30"],
                            [3, "IT-102", "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", "301", "–í—Ç–æ—Ä–æ–π", "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", 1, "09:00", "10:30"]
                        ],
                        errors: [
                            { cell: "1-8", type: "integrity", description: "–ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ: –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ ‚â† –¥–µ–Ω—å ‚Ññ2" },
                            { cell: "1-10", type: "constraint", description: "–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–Ω—å—à–µ –Ω–∞—á–∞–ª–∞" },
                            { cell: "2-5", type: "integrity", description: "–ö–æ–Ω—Ñ–ª–∏–∫—Ç –∞—É–¥–∏—Ç–æ—Ä–∏–π –≤ –æ–¥–Ω–æ –≤—Ä–µ–º—è" },
                            { cell: "3-6", type: "integrity", description: "–ê—É–¥–∏—Ç–æ—Ä–∏—è 301 –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ—Ä–ø—É—Å–∞—Ö?" }
                        ]
                    },
                    {
                        title: "–°–º–µ—à–∞–Ω–Ω—ã–µ —Ä–æ–ª–∏",
                        description: "–ù–∞–π–¥–∏—Ç–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–±–ª–µ–º—ã —Å NULL",
                        headers: ["ID", "–¢–∏–ø", "–ò–º—è", "–ì—Ä—É–ø–ø–∞", "–î–æ–ª–∂–Ω–æ—Å—Ç—å", "–ó–∞—Ä–ø–ª–∞—Ç–∞", "Email", "–¢–µ–ª–µ—Ñ–æ–Ω—ã"],
                        data: [
                            [1, "–°—Ç—É–¥–µ–Ω—Ç", "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤", "IT-101", "-", "-", "ivan@mail.com", "89991112233"],
                            [2, "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å", "–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤", "-", "–ü—Ä–æ—Ñ–µ—Å—Å–æ—Ä", "75000", "petrov@college.ru", "89992223344"],
                            [3, "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å", "–°–µ—Ä–≥–µ–π –°–∏–¥–æ—Ä–æ–≤", "-", "–î–æ—Ü–µ–Ω—Ç", "65000", "petrov@college.ru", "89993334455"],
                            [4, "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä", "–ê–Ω–Ω–∞ –ê–Ω–¥—Ä–µ–µ–≤–∞", "-", "-", "50000", "admin@college.ru", "89994445566,89997778899"]
                        ],
                        errors: [
                            { cell: "3-7", type: "integrity", description: "–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ email –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è" },
                            { cell: "4-8", type: "atomicity", description: "–ù–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ" },
                            { cell: "1-4", type: "normalization", description: "–°–º–µ—à–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ" },
                            { cell: "2-4", type: "normalization", description: "NULL –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ç–∏–ø–æ–≤" }
                        ]
                    }
                ];
            }

            bindEvents() {
                // Error type buttons
                document.querySelectorAll('.error-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.selectErrorType(e.target.dataset.errorType);
                    });
                });

                // Submit button
                document.getElementById('submitBtn').addEventListener('click', () => {
                    this.checkAnswer();
                });

                // Next button
                document.getElementById('nextBtn').addEventListener('click', () => {
                    this.nextTable();
                });

                // Restart button
                document.getElementById('restartBtn').addEventListener('click', () => {
                    this.restartGame();
                });
            }

            loadTable(tableIndex) {
                const table = this.tables[tableIndex];
                if (!table) return;

                // Update UI
                document.getElementById('tableTitle').textContent = table.title;
                document.getElementById('tableDescription').textContent = table.description;

                // Create table
                this.createTable(table);
                
                // Reset selection
                this.selectedCell = null;
                this.selectedErrorType = null;
                this.updateSelectionUI();
                
                // Hide feedback, show game area
                document.getElementById('feedbackContainer').classList.add('hidden');
                document.getElementById('gameArea').classList.remove('hidden');
                document.getElementById('resultsContainer').classList.add('hidden');
            }

            createTable(table) {
                const tableElement = document.getElementById('dataTable');
                tableElement.innerHTML = '';

                // Create header
                const headerRow = document.createElement('tr');
                table.headers.forEach(header => {
                    const th = document.createElement('th');
                    th.textContent = header;
                    headerRow.appendChild(th);
                });
                tableElement.appendChild(headerRow);

                // Create data rows
                table.data.forEach((row, rowIndex) => {
                    const tr = document.createElement('tr');
                    row.forEach((cell, cellIndex) => {
                        const td = document.createElement('td');
                        td.textContent = cell;
                        td.dataset.row = rowIndex + 1;
                        td.dataset.col = cellIndex + 1;
                        
                        // Check if this cell has an error
                        const cellId = `${rowIndex + 1}-${cellIndex + 1}`;
                        const hasError = table.errors.some(error => error.cell === cellId);
                        
                        if (hasError) {
                            td.classList.add('error-cell');
                            const marker = document.createElement('div');
                            marker.className = 'error-marker';
                            marker.textContent = '!';
                            td.appendChild(marker);
                            
                            td.addEventListener('click', () => {
                                this.selectCell(cellId, cell);
                            });
                        }
                        
                        tr.appendChild(td);
                    });
                    tableElement.appendChild(tr);
                });
            }

            selectCell(cellId, cellValue) {
                this.selectedCell = cellId;
                
                // Remove previous selection
                document.querySelectorAll('.error-cell.selected').forEach(cell => {
                    cell.classList.remove('selected');
                });
                
                // Add selection to current cell
                const cellElement = document.querySelector(`[data-row="${cellId.split('-')[0]}"][data-col="${cellId.split('-')[1]}"]`);
                if (cellElement) {
                    cellElement.classList.add('selected');
                }
                
                this.updateSelectionUI(cellId, cellValue);
            }

            selectErrorType(errorType) {
                this.selectedErrorType = errorType;
                
                // Update UI
                document.querySelectorAll('.error-btn').forEach(btn => {
                    btn.classList.remove('selected');
                });
                document.querySelector(`[data-error-type="${errorType}"]`).classList.add('selected');
                
                this.updateSubmitButton();
            }

            updateSelectionUI(cellId = null, cellValue = null) {
                const infoElement = document.getElementById('selectedCellInfo');
                
                if (cellId && cellValue) {
                    const [row, col] = cellId.split('-');
                    infoElement.innerHTML = `
                        <div class="cell-coordinates">–Ø—á–µ–π–∫–∞: –°—Ç—Ä–æ–∫–∞ ${row}, –ö–æ–ª–æ–Ω–∫–∞ ${col}</div>
                        <div class="cell-value">${cellValue}</div>
                    `;
                } else {
                    infoElement.innerHTML = `
                        <div class="cell-coordinates">–í—ã–±–µ—Ä–∏—Ç–µ —è—á–µ–π–∫—É —Å –æ—à–∏–±–∫–æ–π</div>
                        <div class="cell-value">-</div>
                    `;
                }
                
                this.updateSubmitButton();
            }

            updateSubmitButton() {
                const submitBtn = document.getElementById('submitBtn');
                submitBtn.disabled = !(this.selectedCell && this.selectedErrorType);
            }

            checkAnswer() {
                if (!this.selectedCell || !this.selectedErrorType) return;

                const currentTable = this.tables[this.currentTable];
                const correctError = currentTable.errors.find(error => 
                    error.cell === this.selectedCell && error.type === this.selectedErrorType
                );

                const feedbackContainer = document.getElementById('feedbackContainer');
                const feedbackContent = document.getElementById('feedbackContent');
                
                feedbackContainer.classList.remove('hidden');

                if (correctError) {
                    // Correct answer
                    this.score++;
                    feedbackContent.className = 'feedback-content feedback-correct';
                    feedbackContent.innerHTML = `
                        <h4>‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!</h4>
                        <p><strong>–ù–∞–π–¥–µ–Ω–∞ –æ—à–∏–±–∫–∞:</strong> ${correctError.description}</p>
                        <p>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ —Ç–∏–ø –æ—à–∏–±–∫–∏.</p>
                    `;
                } else {
                    // Incorrect answer
                    feedbackContent.className = 'feedback-content feedback-incorrect';
                    const actualError = currentTable.errors.find(error => error.cell === this.selectedCell);
                    
                    if (actualError) {
                        feedbackContent.innerHTML = `
                            <h4>‚ùå –ù–µ —Å–æ–≤—Å–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ</h4>
                            <p><strong>–í—ã–±—Ä–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞:</strong> ${this.getErrorTypeDescription(this.selectedErrorType)}</p>
                            <p><strong>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø:</strong> ${this.getErrorTypeDescription(actualError.type)}</p>
                            <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${actualError.description}</p>
                        `;
                    } else {
                        feedbackContent.innerHTML = `
                            <h4>‚ùå –û—à–∏–±–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</h4>
                            <p>–≠—Ç–∞ —è—á–µ–π–∫–∞ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—à–∏–±–∫–∏ –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥—Ä—É–≥—É—é –ø—Ä–æ–±–ª–µ–º—É.</p>
                        `;
                    }
                }
            }

            getErrorTypeDescription(type) {
                const descriptions = {
                    'atomicity': '–ù–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏',
                    'redundancy': '–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö', 
                    'integrity': '–ù–∞—Ä—É—à–µ–Ω–∏–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏',
                    'normalization': '–ù–∞—Ä—É—à–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏',
                    'constraint': '–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫'
                };
                return descriptions[type] || type;
            }

            nextTable() {
                this.currentTable++;
                
                if (this.currentTable < this.totalTables) {
                    this.loadTable(this.currentTable);
                    this.updateProgress();
                } else {
                    this.showResults();
                }
            }

            updateProgress() {
                const progress = (this.currentTable / this.totalTables) * 100;
                document.getElementById('progressFill').style.width = `${progress}%`;
                document.getElementById('progressText').textContent = `–¢–∞–±–ª–∏—Ü–∞ ${this.currentTable + 1} –∏–∑ ${this.totalTables}`;
                document.getElementById('progressPercent').textContent = `${Math.round(progress)}%`;
            }

            showResults() {
                document.getElementById('gameArea').classList.add('hidden');
                document.getElementById('feedbackContainer').classList.add('hidden');
                document.getElementById('resultsContainer').classList.remove('hidden');
                
                document.getElementById('finalScore').textContent = `${this.score}/${this.totalTables}`;
                
                let message = '';
                if (this.score === this.totalTables) {
                    message = '–ò–¥–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –í—ã –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç–µ—Å—å –≤ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö! üéâ';
                } else if (this.score >= this.totalTables * 0.7) {
                    message = '–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –í—ã —Ö–æ—Ä–æ—à–æ –ø–æ–Ω–∏–º–∞–µ—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î! üëç';
                } else if (this.score >= this.totalTables * 0.5) {
                    message = '–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏–∑—É—á–∞—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö. üí™';
                } else {
                    message = '–ï—Å—Ç—å –Ω–∞–¥ —á–µ–º –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å! –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏. üìö';
                }
                
                document.getElementById('resultsMessage').textContent = message;
            }

            restartGame() {
                this.currentTable = 0;
                this.score = 0;
                this.loadTable(this.currentTable);
                this.updateProgress();
            }
        }

        // Initialize the game when page loads
        let game;
        document.addEventListener('DOMContentLoaded', () => {
            game = new DatabaseErrorGame();
        });
    </script>
</body>
</html>